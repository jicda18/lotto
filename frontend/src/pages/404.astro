---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import Image from 'astro/components/Image.astro';

const title = 'Página no encontrada - Error 404';
const description = 'La página que buscas no existe o ha sido movida.';

const lotteries = await getCollection('lotteries');
const logos: Record<string, any> = import.meta.glob('@/assets/lotteries/*.png', { eager: true });
---

<Layout title={title} description={description}>
    <div slot="hero">
        <div class="flex justify-center gap-4 my-6">
            <span class="flex items-center justify-center w-12 h-12 bg-linear-to-br from-primary-100 via-primary-700 to-primary-900 text-white rounded-full font-bold text-lg shadow-sm">4</span>
            <span class="flex items-center justify-center w-12 h-12 bg-linear-to-br from-gold-100 via-gold-300 to-gold-500 text-white rounded-full font-bold text-lg shadow-sm">0</span>
            <span class="flex items-center justify-center w-12 h-12 bg-linear-to-br from-primary-100 via-primary-700 to-primary-900 text-white rounded-full font-bold text-lg shadow-sm">4</span>
        </div>

        <div class="mb-12">
            <h2 class="text-3xl lg:text-4xl font-bold text-white mb-0">
                ¡Oops! Página no encontrada
            </h2>
            <p class="text-xs text-gray-300 leading-relaxed max-w-lg mx-auto">
                La página que buscas no existe, ha sido movida o el enlace es incorrecto.
            </p>
      </div>
    </div>
    
    <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <button id="go-back-btn" class="inline-flex items-center justify-center px-8 py-3 bg-primary-500 hover:bg-primary-600 dark:bg-primary-700 dark:hover:bg-primary-800 text-white font-semibold rounded-xl transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
                <svg class="w-5 h-5 mr-2" fill="currentColor" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
            
                Página Anterior
            </button>

            <a  href="/" class="inline-flex items-center justify-center px-8 py-3 bg-gold-300 hover:bg-gold-400 dark:bg-gold-400 dark:hover:bg-gold-500 text-white font-semibold rounded-xl transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="currentColor" stroke="currentColor" viewBox="0 0 640 640">
                    <path d="M298.2 72.6C310.5 61.2 329.5 61.2 341.7 72.6L432 156.3L432 144C432 126.3 446.3 112 464 112L496 112C513.7 112 528 126.3 528 144L528 245.5L565.8 280.6C575.4 289.6 578.6 303.5 573.8 315.7C569 327.9 557.2 336 544 336L528 336L528 512C528 547.3 499.3 576 464 576L176 576C140.7 576 112 547.3 112 512L112 336L96 336C82.8 336 71 327.9 66.2 315.7C61.4 303.5 64.6 289.5 74.2 280.6L298.2 72.6zM304 384C277.5 384 256 405.5 256 432L256 528L384 528L384 432C384 405.5 362.5 384 336 384L304 384z"/>
                </svg>

                Volver al Inicio
            </a>
        </div>
        
        <div class="mt-16 bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-sm border border-gray-200 dark:border-gray-700">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">
                ¿Buscabas alguna de estas páginas?
            </h3>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                {lotteries.map((lottery) => {
                    const logoSrc = logos[`/src/assets/lotteries/${lottery.id}.png`]?.default;

                    return <a href={`/lotteries/${lottery.data.slug}`} class="flex p-4 bg-gray-100 rounded-xl hover:bg-primary-100 dark:hover:bg-primary-700 transition-colors">
                        {logoSrc 
                            ? <Image src={logoSrc} alt={`${lottery.data.name} Logo`} class="max-h-16 max-w-full h-auto w-auto object-contain m-auto" />
                            : <span class="m-auto font-bold">{lottery.data.name}</span>
                        }
                    </a>;
                })}
            </div>
        </div>
    </div>
</Layout>

<script>
    const goBackBtn = document.getElementById('go-back-btn');

    goBackBtn?.addEventListener('click', () => {
        if (window.history.length > 1) {
            window.history.back();
        } else {
            window.location.href = "/";
        }
    });
</script>