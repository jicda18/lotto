---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import logo_light from '@/assets/logo_light.png';
import logo_dark from '@/assets/logo_dark.png';
import NavBar from './NavBar.astro';
import NavBarMobile from './NavBarMobile.astro';

const lotteries = await getCollection('lotteries');

const navItems = [
  { path: "/", label: "Inicio" },
  { label: "Loterías", children: lotteries.map((lottery) => ({
      path: `/lotteries/${lottery.data.slug}`,
      label: lottery.data.name,
    }))
  }
];
---

<header class="bg-white/95 border-b border-gray-200 sticky top-0 z-50 backdrop-blur-sm dark:bg-primary-800 dark:border-gray-800">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <nav class="flex md:justify-between items-center py-4">
      <a href="/" class="flex flex-1 md:flex-0 items-center space-x-3 text-primary-900 hover:text-primary-700 transition-colors">
        <Image src={logo_light} alt="Lotto Logo" height="32" class="shrink-0 block dark:hidden" />
        <Image src={logo_dark} alt="Lotto Logo" height="32" class="shrink-0 hidden dark:block" />
      </a>
      
      <NavBar items={navItems} />

      <button 
          id="mobile-menu-button"
          class="md:hidden p-2 rounded-md text-gray-600 dark:text-gray-300 hover:text-primary-900 dark:hover:text-primary-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
          aria-label="Abrir menú"
      >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
      </button>
    </nav>
  </div>

  <NavBarMobile items={navItems} />
</header>

<script>
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuButton?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });
</script>

